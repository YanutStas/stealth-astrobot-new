/*  src/commands/Client/Free/general.js  */
const { DateTime } = require("luxon");
const createFeature = require("./freeFactory");

/* ะฒะฐะปะธะดะฐัะธั ะฒะฒะพะดะฐ */
const natalReg = /^\d{2}\.\d{2}\.\d{4}\s+\d{2}:\d{2}\s+.+$/;
const isValid = (txt) =>
  natalReg.test(txt.trim()) &&
  DateTime.fromFormat(
    txt.split(/\s+/).slice(0, 2).join(" "),
    "dd.MM.yyyy HH:mm"
  ).isValid;

/* ัะธััะตะผะบะฐ ัะพะปัะบะพ ะดะปั ะดะฐะฝะฝะพะน ัะธัะธ */
const SYS_MSG =
  "ะะธัะธ ัััะพะณะพ 7 ะฟัะฝะบัะฐะผะธ + ะธัะพะณะพะผ. ะะฐะฟัะตัะตะฝะพ ัะฟะพะผะธะฝะฐัั ะปัะฑะพะฒั, ะดะตะฝัะณะธ ะธ ัะพะฒะผะตััะธะผะพััั.";

/* โ ัะบัะฟะพัั ะดะปั index.js โ */
module.exports = (bot, flow) =>
  createFeature(bot, flow, {
    buttonId: "general_start",

    askText:
      "ะงัะพะฑั ั ัะพััะฐะฒะธะป *ะฝะฐัะฐะปัะฝัั ะบะฐััั*, ะฟัะธัะปะธ ะดะฐะฝะฝัะต ะพะดะฝะพะน ัััะพะบะพะน:\n\n" +
      "๐ ะะ.MM.ะะะะ   โฐ ะงะง:ะะ   ๐บ ะะพัะพะด\n\n" +
      "ะัะธะผะตั: 01.01.2000 10:00 ะะพัะบะฒะฐ",

    waitText: "๐ญ ะกะบะฐะฝะธััั ะทะฒัะทะดัโฆ",

    regExp: natalReg,

    validate: ([txt]) => isValid(txt),

    sysMsg: SYS_MSG,

    buildPrompt: ([full]) =>
      `
ะกะดะตะปะฐะน ะบัะฐัะบะธะน ะดััะถะตะปัะฑะฝัะน ะพัััั (โค1200 ัะธะผ) ะฟะพ 7 ะฟัะฝะบัะฐะผ:

1. โ๏ธ ะกะพะปะฝัะต โ ัะฐัะฐะบัะตั
2. ๐ ะัะฝะฐ โ ัะผะพัะธะธ
3. ๐กฑ ะััะตะฝะดะตะฝั โ ะฒะฝะตัะฝะตะต ยซัยป
4. ๐ ะะฟัั ะธ ะทะฝะฐะฝะธั
5. ๐จ ะขะฐะปะฐะฝัั ะธ ัะพะฑะฑะธ
6. ๐ง ะะดะพัะพะฒัะต ะธ ัะตัััั
7. ๐ ะะฝัััะตะฝะฝะธะน ะบะพะฝัะปะธะบั

โ
โจ ะ ะธัะพะณะต: (1โ2 ะฟัะตะดะปะพะถะตะฝะธั)

ะะฐัะฐ ัะพะถะดะตะฝะธั: ${full.trim()}`.trim(),
  });
